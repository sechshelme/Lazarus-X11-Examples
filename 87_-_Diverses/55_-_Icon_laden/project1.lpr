//image image.png
(*
Icon erzeuugen
*)
//lineal
//code+
program project1;

uses
  ctypes,
  unixtype,
  xlib,
  xutil,
  keysym,
  x;

  // https://stackoverflow.com/questions/10699927/xlib-argb-window-icon

  // https://github.com/xeyownt/xseticon/tree/master

var
  dis: PDisplay;
  win: TWindow;
  Event: TXEvent;
  scr: cint;

  procedure Load_Icon;
  const
    IconData: record
      ico1: record
        Width, Height: culong;
        Data: array[0..16 * 16 - 1] of culong;
        end;
      ico2: record
        Width, Height: culong;
        Data: array[0..32 * 32 - 1] of culong;
        end;
      end
    = (
      ico1: (Width: 16; Height: 16; Data: (
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $142600D9, $DA0000FF, $00000000, $0AFF0000, $0E0000FF, $B60000FF, $C00000FF, $700000FF,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $490000FF,
      $C50000FF, $E70000FF, $00000000, $00000000, $7B0000FF, $4D0000FF, $00000000, $040000FF,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $02FF0000, $CC0000FF, $00000000, $00000000, $B70000FF, $7B0000FF, $B20000FF, $2E0000FF,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $CC0000FF, $00000000, $00000000, $C90000FF, $5A0000FF, $2A0000FF, $C80000FF,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $00000000, $CC0000FF, $00000000, $07FF0000, $BE0000FF, $0F0000FF, $00000000, $CD0000FF,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $CC0000FF, $00000000, $00000000, $8B0000FF, $500000FF, $0A0000FF, $C70000FF,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $00000000, $CC0000FF, $00000000, $00000000, $1A0000FF, $C60300FC, $CE0000FF, $520000FF,
      $FF00FF00, $F000FF00, $E000FF00, $D000FF00, $BF00FF00, $B000FF00, $A000FF00, $8F00FF00,
      $7F00FF00, $6E00FF00, $5F00FF00, $4E00FF00, $3E00FF00, $2D00FF00, $1D00FF00, $0E00FF00,
      $FF00FF00, $F100FF00, $E100FF00, $D100FF00, $C000FF00, $B000FF00, $9F00FF00, $8F00FF00,
      $7F00FF00, $6F00FF00, $6100FA05, $5100F609, $4000F708, $2F00F40B, $1E00F709, $0D00FF00,
      $FF00FF00, $F100FF00, $E000FF00, $D100FF00, $C000FF00, $B000FF00, $A000FF00, $9000FF00,
      $7F00FF00, $6F00FF00, $5E00FF00, $4E00FF00, $3E00FF00, $2D00FF00, $1D00FF00, $0D00FF00,
      $FF0000FF, $F00000FF, $E00000FF, $D00000FF, $C00000FF, $B00000FF, $9F0000FF, $900000FF,
      $7F0000FF, $6F0000FF, $5F0000FF, $4F0000FF, $3F0000FF, $2E0000FF, $1F0000FF, $0E0000FF,
      $FF0000FF, $F00000FF, $E00000FF, $D00000FF, $C00000FF, $B00000FF, $9F0000FF, $900000FF,
      $7F0000FF, $6F0000FF, $5F0000FF, $4F0000FF, $3F0000FF, $2E0000FF, $1E0000FF, $0E0000FF,
      $FF0000FF, $F00000FF, $E00000FF, $D00000FF, $C00000FF, $B00000FF, $A00000FF, $8F0000FF,
      $7F0000FF, $6F0000FF, $5F0000FF, $4F0000FF, $3E0000FF, $2E0000FF, $1F0000FF, $0E0000FF,
      $FFFF0000, $F0FF0000, $E0FF0000, $D0FF0000, $BFFF0000, $AFFF0000, $9FFF0000, $8EFF0000,
      $7FFF0000, $6EFF0000, $5EFF0000, $4DFF0000, $3DFF0000, $2DFF0000, $1DFF0000, $0DFF0000,
      $FFFF0000, $F1FF0000, $DFFF0000, $D0FF0000, $BFFF0000, $AFFF0000, $9FFF0000, $8FFF0000,
      $7EFF0000, $6EFF0000, $5EFF0000, $4DFF0000, $3DFF0000, $2DFF0000, $1DFF0000, $0DFF0000,
      $FFFF0000, $F0FF0000, $E0FF0000, $CFFF0000, $C0FF0000, $AFFF0000, $9FFF0000, $8FFF0000,
      $7FFF0000, $6EFF0000, $5EFF0000, $4EFF0000, $3EFF0000, $2EFF0000, $1DFF0000, $0DFF0000));
      ico2: (Width: 32; Height: 32; Data: (
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $0FFF0000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $5A0000FF, $BA0000FF, $EF0000FF, $FA0000FF, $DC0000FF, $7F0000FF, $050000FF, $00000000,
      $030000FF, $650000FF, $BD0000FF, $EE0000FF, $FB0000FF, $DA0000FF, $700000FF, $010000FF,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $B80000FF, $880000FF, $470000FF, $3E0000FF, $790000FF, $F60000FF, $990000FF, $00000000,
      $010000FF, $C20000FF, $820000FF, $470000FF, $3A0000FF, $790000FF, $F90000FF, $7F0000FF,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $840000FF, $F40000FF, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $890000FF, $E90000FF,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $840000FF, $D70000FF, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $740000FF, $F40000FF,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $00000000, $00000000, $200000FF, $470000FF, $880000FF, $B40000FF, $260000FF, $00000000,
      $00000000, $00000000, $05FF0000, $0EFF0000, $01FF0000, $00000000, $C60000FF, $AE0000FF,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $980000FF, $FF0000FF, $FF0000FF, $CB0000FF, $220000FF, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $7A0000FF, $F10000FF, $250000FF,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $01FF0000, $00000000, $00000000, $0D0000FF, $4D0000FF, $E50000FF, $CA0000FF, $00000000,
      $00000000, $00000000, $00000000, $00000000, $770000FF, $F40000FF, $400000FF, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $690000FF, $FF0000FF, $090000FF,
      $00000000, $00000000, $040000FF, $980000FF, $E90000FF, $350000FF, $00000000, $00000000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $820000FF, $EA0000FF, $00000000,
      $00000000, $0D0000FF, $B70000FF, $D80000FF, $220000FF, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $300000FF,
      $C40000FF, $6B0000FF, $3E0000FF, $3D0000FF, $850000FF, $FB0000FF, $650000FF, $00000000,
      $160000FF, $CE0000FF, $E40000FF, $460000FF, $340000FF, $340000FF, $340000FF, $340000FF,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFF1000E,
      $7A0200FD, $CC0000FF, $F50000FF, $F90000FF, $CB0000FF, $540000FF, $00000000, $00000000,
      $540000FF, $FF0000FF, $FF0000FF, $FF0000FF, $FF0000FF, $FF0000FF, $FF0000FF, $FF0000FF,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000, $FFFF0000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000, $00000000,
      $FF00FF00, $F700FF00, $EF00FF00, $E700FF00, $DF00FF00, $D700FF00, $CF00FF00, $C700FF00,
      $BF00FF00, $B600FF00, $AF00FF00, $A700FF00, $9E00FF00, $9600FF00, $8E00FF00, $8700FF00,
      $7E00FF00, $7700FF00, $6F00FF00, $6700FF00, $5E00FF00, $5700FF00, $4F00FF00, $4700FF00,
      $3E00FF00, $3700FF00, $2E00FF00, $2600FF00, $1E00FF00, $1700FF00, $0E00FF00, $0600FF00,
      $FF00FF00, $F700FF00, $EF00FF00, $E700FF00, $DE00FF00, $D700FF00, $CF00FF00, $C700FF00,
      $BF00FF00, $B700FF00, $AF00FF00, $A700FF00, $9F00FF00, $9600FF00, $8F00FF00, $8700FF00,
      $7F00FF00, $7700FF00, $6E00FF00, $6700FF00, $5F00FF00, $5700FF00, $4E00FF00, $4700FF00,
      $3F00FF00, $3700FF00, $2F00FF00, $2600FF00, $1E00FF00, $1600FF00, $0E00FF00, $0700FF00,
      $FF00FF00, $F700FF00, $EF00FF00, $E700FF00, $DF00FF00, $D700FF00, $CF00FF00, $C700FF00,
      $BF00FF00, $B600FF00, $AE00FF00, $A700FF00, $9E00FF00, $9700FF00, $8F00FF00, $8700FF00,
      $7E00FF00, $7700FF00, $6F00FF00, $6700FF00, $5F00FF00, $5700FF00, $4F00FF00, $4700FF00,
      $3E00FF00, $3600FF00, $2E00FF00, $2700FF00, $1E00FF00, $1600FF00, $0E00FF00, $0700FF00,
      $FF00FF00, $F700FF00, $EF00FF00, $E600FF00, $DF00FF00, $D700FF00, $CF00FF00, $C700FF00,
      $BF00FF00, $B700FF00, $AF00FF00, $A700FF00, $9F00FF00, $9700FF00, $8E00FF00, $8700FF00,
      $7F00FF00, $7600FF00, $6F00FF00, $6700FF00, $5E00FF00, $5600FF00, $4F00FF00, $4700FF00,
      $3E00FF00, $3700FF00, $2E00FF00, $2600FF00, $1E00FF00, $1600FF00, $0E00FF00, $0600FF00,
      $FF00FF00, $F700FF00, $EF00FF00, $E700FF00, $DF00FF00, $D700FF00, $CF00FF00, $C700FF00,
      $BF00FF00, $B700FF00, $AE00FF00, $A700FF00, $9F00FF00, $9700FF00, $8F00FF00, $8700FF00,
      $7E00FF00, $7700FF00, $6F00FF00, $6700FF00, $5F00FF00, $5600FF00, $5000FC03, $4600FF00,
      $3F00FF00, $3600FF00, $2F00FF00, $2700FF00, $1E00FF00, $1700FF00, $0F00FF00, $0600FF00,
      $FF0000FF, $F80000FF, $F00000FF, $E80000FF, $DF0000FF, $D80000FF, $CF0000FF, $C70000FF,
      $C00000FF, $B70000FF, $B00000FF, $A80000FF, $9F0000FF, $970000FF, $8F0000FF, $870000FF,
      $800000FF, $770000FF, $6F0000FF, $670000FF, $5F0000FF, $570000FF, $4F0000FF, $470000FF,
      $3F0000FF, $370000FF, $2F0000FF, $270000FF, $1F0000FF, $170000FF, $0F0000FF, $070000FF,
      $FF0000FF, $F80000FF, $F00000FF, $E80000FF, $DF0000FF, $D80000FF, $D00000FF, $C80000FF,
      $C00000FF, $B80000FF, $AF0000FF, $A70000FF, $9F0000FF, $970000FF, $8F0000FF, $880000FF,
      $7F0000FF, $770000FF, $6F0000FF, $670000FF, $5F0000FF, $570000FF, $4F0000FF, $470000FF,
      $3F0000FF, $370000FF, $2F0000FF, $270000FF, $1F0000FF, $170000FF, $0E0000FF, $060000FF,
      $FF0000FF, $F80000FF, $F00000FF, $E80000FF, $E00000FF, $D80000FF, $D00000FF, $C80000FF,
      $C00000FF, $B80000FF, $AF0000FF, $A70000FF, $9F0000FF, $980000FF, $900000FF, $870000FF,
      $7F0000FF, $770000FF, $6F0000FF, $670000FF, $5F0000FF, $570000FF, $4F0000FF, $470000FF,
      $3F0000FF, $370000FF, $2F0000FF, $270000FF, $1E0000FF, $160000FF, $0F0000FF, $060000FF,
      $FF0000FF, $F80000FF, $F00000FF, $E80000FF, $E00000FF, $D80000FF, $D00000FF, $C80000FF,
      $BF0000FF, $B80000FF, $AF0000FF, $A80000FF, $9F0000FF, $970000FF, $8F0000FF, $870000FF,
      $7F0000FF, $770000FF, $700000FF, $670000FF, $5F0000FF, $570000FF, $4F0000FF, $470000FF,
      $3F0000FF, $370000FF, $2F0000FF, $270000FF, $1F0000FF, $170000FF, $0F0000FF, $070000FF,
      $FF0000FF, $F80000FF, $F00000FF, $E80000FF, $E00000FF, $D80000FF, $D00000FF, $C80000FF,
      $C00000FF, $B80000FF, $B00000FF, $A80000FF, $9F0000FF, $970000FF, $8F0000FF, $870000FF,
      $800000FF, $780000FF, $6F0000FF, $680000FF, $600000FF, $580000FF, $500000FF, $470000FF,
      $3F0000FF, $370000FF, $2F0000FF, $270000FF, $1F0000FF, $170000FF, $0F0000FF, $060000FF,
      $FFFF0000, $F7FF0000, $EFFF0000, $E8FF0000, $E0FF0000, $D7FF0000, $CFFF0000, $C7FF0000,
      $C0FF0000, $B8FF0000, $AFFF0000, $A7FF0000, $9FFF0000, $97FF0000, $8FFF0000, $87FF0000,
      $7FFF0000, $77FF0000, $6FFF0000, $67FF0000, $5EFF0000, $57FF0000, $4EFF0000, $47FF0000,
      $3EFF0000, $37FF0000, $2EFF0000, $26FF0000, $1EFF0000, $16FF0000, $0EFF0000, $06FF0000,
      $FFFF0000, $F8FF0000, $F0FF0000, $E8FF0000, $E0FF0000, $D8FF0000, $D0FF0000, $C7FF0000,
      $BFFF0000, $B7FF0000, $AFFF0000, $A7FF0000, $A0FF0000, $97FF0000, $8FFF0000, $87FF0000,
      $7FFF0000, $77FF0000, $6FFF0000, $66FF0000, $5FFF0000, $57FF0000, $4EFF0000, $46FF0000,
      $3FFF0000, $36FF0000, $2EFF0000, $26FF0000, $1EFF0000, $16FF0000, $0EFF0000, $05FF0000,
      $FFFF0000, $F8FF0000, $F0FF0000, $E8FF0000, $E0FF0000, $D8FF0000, $CFFF0000, $C8FF0000,
      $C0FF0000, $B8FF0000, $AFFF0000, $A7FF0000, $A0FD0002, $97FF0000, $8FFF0000, $87FF0000,
      $7FFF0000, $77FF0000, $6FFF0000, $67FF0000, $5FFF0000, $56FF0000, $4FFF0000, $46FF0000,
      $3EFF0000, $36FF0000, $2EFF0000, $27FF0000, $1EFF0000, $16FF0000, $0EFF0000, $05FF0000,
      $FFFF0000, $F8FF0000, $F0FF0000, $E8FF0000, $E0FF0000, $D8FF0000, $CFFF0000, $C8FF0000,
      $C0FF0000, $B7FF0000, $B0FF0000, $A7FF0000, $9FFF0000, $97FF0000, $90FF0000, $87FF0000,
      $7FFF0000, $77FF0000, $6EFF0000, $67FF0000, $5FFF0000, $57FF0000, $4FFF0000, $46FF0000,
      $3EFF0000, $36FF0000, $2EFF0000, $26FF0000, $1EFF0000, $16FF0000, $0EFF0000, $06FF0000,
      $FFFF0000, $F8FF0000, $F0FF0000, $E8FF0000, $E0FF0000, $D7FF0000, $D0FF0000, $C8FF0000,
      $C0FF0000, $B8FF0000, $AFFF0000, $A8FF0000, $9FFF0000, $97FF0000, $90FF0000, $87FF0000,
      $7FFF0000, $79FB0004, $6EFF0000, $67FF0000, $5FFF0000, $57FF0000, $4FFF0000, $47FF0000,
      $3EFF0000, $37FF0000, $2EFF0000, $26FF0000, $1FF70008, $16FF0000, $0EFF0000, $07FF0000)));

  var
    XA__NET_WM_ICON, XA_CARDINAL: TAtom;
    len: integer;
  begin
    XA__NET_WM_ICON := XInternAtom(dis, '_NET_WM_ICON', True);
    XA_CARDINAL := XInternAtom(dis, 'CARDINAL', True);
    len := 2 + 16 * 16 + 2 + 32 * 32;
    XChangeProperty(dis, win, XA__NET_WM_ICON, XA_CARDINAL, 32, PropModePrepend, @IconData, len);
  end;

begin
  dis := XOpenDisplay(nil);
  if dis = nil then begin
    WriteLn('Kann nicht das Display Ã¶ffnen');
    Halt(1);
  end;
  scr := DefaultScreen(dis);

  win := XCreateSimpleWindow(dis, RootWindow(dis, scr), 10, 10, 320, 240, 1, BlackPixel(dis, scr), WhitePixel(dis, scr));

  XSelectInput(dis, win, KeyPressMask);
  XStoreName(dis, win, 'Mein Fenster');

  XMapWindow(dis, win);

  while (True) do begin
    XNextEvent(dis, @Event);
    case Event._type of
      KeyPress: begin
        // Beendet das Programm bei [ESC]
        case XLookupKeysym(@Event.xkey, 0) of
          XK_Escape: begin
            Break;
          end;
          XK_space: begin
            Load_Icon;
          end;
        end;
      end;
    end;
  end;

  XDestroyWindow(dis, win);
  XCloseDisplay(dis);
end.
//code-
